<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Slot 2 Redbox Bounce on Enter</title>
  <style>
    /* ───── Container & Sticky Card ───── */
    #scroll-container {
      height: 200vh; /* Enough vertical space to scroll from 0→100% */
    }

    #sticky-card {
      position: sticky;
      top: 50vh;
      transform: translateY(-50%);
      perspective: 600px;
    }

    .card-content {
      position: absolute;
      inset: 0;
    }

    #card {
      height: 350px;
      border-radius: 1rem;
      background-image: url('lbox.png');
      background-size: cover;
      background-position: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow: visible;
    }

    /* ───── Slot 1 Elements (snap instantly) ───── */
    #slot-1 .anim1 {
      will-change: transform, opacity;
      transition: none; /* no tweening—just snap */
    }

    /* ───── Slot 2 Elements (excluding #redbox) ───── */
    #slot-2 .anim2 {
      will-change: transform, opacity;
      transition: none; /* JS will set transform/opacity per frame */
    }

    /* ───── Redbox Initial State ───── */
    #redbox {
      position: absolute;
      left: 50%;
      /* We’ll control vertical position via JS’s translateY; start off-screen */
      transform: translateX(-50%) translateY(80px);
      opacity: 0;
    }

    /* ───── Bounce-Up Keyframes for Slot 2 Entry ───── */
    @keyframes bounceUp {
      0% {
        transform: translateX(-50%) translateY(80px);
        opacity: 0;
      }
      30% {
        transform: translateX(-50%) translateY(-10px);
        opacity: 1;
      }
      60% {
        transform: translateX(-50%) translateY(4px);
      }
      100% {
        transform: translateX(-50%) translateY(0px);
      }
    }

    /* ───── Applied to #redbox when entering Slot 2 ───── */
    #redbox.bounce-enter {
      animation: bounceUp 0.8s ease-out forwards;
    }
  </style>
</head>
<body class="bg-gray-100">

  <div id="scroll-container" class="relative">
    <div id="sticky-card" class="w-full max-w-sm mx-auto">
      <div id="card" class="relative">

        <!-- ====== SLOT 1 ====== -->
        <div id="slot-1" class="card-content p-6">
          <!-- These elements have class="anim1" so they “snap” instantly when p1=0 -->
          <h2 id="h1" class="anim1 text-3xl font-bold text-white drop-shadow-lg absolute top-4 left-4">
            Team
          </h2>
          <div id="b1" class="anim1 absolute top-2 left-2 bg-blue-600 text-white px-2 py-1 rounded-full text-xs drop-shadow">
            John S.
          </div>
          <div id="b2" class="anim1 absolute bottom-2 right-2 bg-red-400 text-white px-2 py-1 rounded-full text-xs drop-shadow">
            Lilianna
          </div>
          <div id="a1" class="anim1 absolute top-12 left-20 w-0 h-0 border-l-6 border-r-6 border-b-6 border-transparent border-b-black rotate-45 drop-shadow"></div>
          <div id="a2" class="anim1 absolute bottom-12 right-20 w-0 h-0 border-l-6 border-r-6 border-t-6 border-transparent border-t-black rotate-45 drop-shadow"></div>
          <!-- “Collaborate” text stays static when in Slot 1 -->
          <div class="absolute bottom-20 left-6">
            <h3 id="t1" class="text-lg font-semibold text-white drop-shadow">Collaborate</h3>
            <p id="p1" class="text-white text-sm drop-shadow">
              Enhance teamwork with powerful real-time collaboration features.
            </p>
          </div>
        </div>

        <!-- ====== SLOT 2 ====== -->
        <div id="slot-2" class="card-content p-6">
          <!-- Other Slot 2 elements (static fade/fly in via JS) -->
          <div class="absolute top-4 left-4">
            <div id="b3" class="anim2 bg-blue-500 text-white px-2 py-1 rounded-full text-xs drop-shadow">
              v1.2
            </div>
          </div>
          <div class="absolute left-0 top-1/2 transform -translate-y-1/2">
            <div id="a3" class="anim2 bg-blue-500 w-8 h-8 flex items-center justify-center rounded-full shadow-lg drop-shadow">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="w-5 h-5 text-white">
                <path d="M24,46A22,22,0,1,1,46,24,22,22,0,0,1,24,46Z" fill="#38b1e7"/>
                <circle cx="24" cy="24" r="16" fill="#b7e3f6"/>
                <path d="M29.09,29.78a2,2,0,0,1-1.19-.39l-5.09-3.78A2,2,0,0,1,22,24V16a2,2,0,0,1,4,0v7l4.29,3.18A2,2,0,0,1,29.09,29.78Z" fill="#495660"/>
              </svg>
            </div>
          </div>

          <!-- REDBOX PNG: initially hidden; will get “.bounce-enter” on crossing into Slot 2 -->
          <div id="redbox">
            <img src="redbox.png"
                 alt="Version Stack"
                 class="w-[250%] h-[250] rounded-xl shadow-lg"/>
          </div>

          <!-- “Version History” text -->
          <div class="absolute bottom-6 left-6">
            <h3 id="t2" class="text-lg font-semibold text-white drop-shadow">Version History</h3>
            <p id="p2" class="text-white text-sm drop-shadow">
              Track every edit effortlessly, and never lose a single change.
            </p>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    (function() {
      const container = document.getElementById('scroll-container');
      const vh = window.innerHeight;
      const maxScroll = () => container.offsetHeight - vh;

      // Slot 1 elements (fly up & fade out); “snap” back when p1 = 0
      const slot1Els = ['h1','b1','b2','a1','a2']
        .map(id => document.getElementById(id));

      // Slot 2 elements (fly in & fade in); except redbox is handled separately
      const slot2Els = ['b3','a3']
        .map(id => document.getElementById(id));

      // Redbox container & “has-bounced” flag
      const redbox   = document.getElementById('redbox');
      let inSlot2    = false; // tracks whether we’re currently ≥50%

      function update() {
        const scrollY = window.scrollY;
        // Normalize to [0..1]
        const prog = Math.min(Math.max(scrollY / maxScroll(), 0), 1);
        const half = 0.5;

        // p1: 0→1 over 0%–50% scroll; p2: 0→1 over 50%–100% scroll
        const p1 = Math.min(Math.max((prog - 0) / half, 0), 1);
        const p2 = Math.min(Math.max((prog - half) / half, 0), 1);

        /* ───── SLOT 1 — fly up & fade out; snap back at p1=0 ───── */
        slot1Els.forEach(el => {
          if (p1 === 0) {
            // Snap instantly into place
            el.style.transform = 'translateY(0)';
            el.style.opacity   = '1';
          } else {
            // Animate Y from 0 → –100px, opacity from 1 → 0
            el.style.transform = `translateY(${-100 * p1}px)`;
            el.style.opacity   = `${1 - p1}`;
          }
        });
        // t1 & p1 text: instantly show/hide
        document.getElementById('t1').style.opacity = (prog < 0.5 ? '1' : '0');
        document.getElementById('p1').style.opacity = (prog < 0.5 ? '1' : '0');

        /* ───── SLOT 2 — fly in & fade in; plus bounce only once on entering ───── */
        // First, handle the two “anim2” elements (b3, a3):
        slot2Els.forEach(el => {
          if (p2 === 0) {
            // Instantly off-screen & hidden
            el.style.transform = 'translateY(-80px)';
            el.style.opacity   = '0';
          } else {
            // TranslateY: from -80px → 0 as p2 goes 0→1; opacity 0→1
            const translateY = -80 + 80 * p2;
            el.style.transform = `translateY(${translateY}px)`;
            el.style.opacity   = `${p2}`;
          }
        });
        // t2 & p2 text: instantly show/hide based on p2
        document.getElementById('t2').style.opacity = (prog >= 0.5 ? '1' : '0');
        document.getElementById('p2').style.opacity = (prog >= 0.5 ? '1' : '0');

        // Now, REDBOX itself:
        if (p2 > 0) {
          // Just now crossing into Slot 2?
          if (!inSlot2) {
            inSlot2 = true;
            // Remove any existing classes, then force a reflow before adding .bounce-enter
            redbox.style.opacity = '0';
            redbox.style.transform = 'translateX(-50%) translateY(80px)';
            redbox.classList.remove('bounce-enter');
            // Force reflow:
            void redbox.offsetWidth;
            // Now add bounce class:
            redbox.classList.add('bounce-enter');
          }
        } else {
          // Scroll back above 50%: hide redbox and reset flag
          inSlot2 = false;
          redbox.classList.remove('bounce-enter');
          redbox.style.opacity = '0';
          redbox.style.transform = 'translateX(-50%) translateY(80px)';
        }
      }

      window.addEventListener('scroll', update);
      window.addEventListener('resize', update);
      update();
    })();
  </script>
</body>
</html>
